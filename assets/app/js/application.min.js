"undefined"==typeof window.Wyliodrin&&(window.Wyliodrin={}),function(a){"use strict";a.schemed={parts:[],partsPath:"assets/app/parts/parts.json"}}(Wyliodrin),function(){"use strict";function a(){t.attr("patternTransform","translate("+d3.event.translate+") scale("+d3.event.scale+")"),s.select("path").attr("stroke-width",.5/d3.event.scale),t.select("path").attr("stroke-width",1/d3.event.scale),v.attr("transform","translate("+d3.event.translate+") scale("+d3.event.scale+")")}function b(){d3.event.sourceEvent.stopPropagation(),d3.select(this).classed("dragging",!0)}function c(){d3.select(this).attr("x",d3.event.x).attr("y",d3.event.y)}function d(){d3.select(this).classed("dragging",!1)}function e(a,b,c){var d=localStorage.getItem("parts");return null!==d?(Wyliodrin.schemed.parts=JSON.parse(d),void b.$emit("loaded.wyliodrin.parts")):void a.get(Wyliodrin.schemed.partsPath,{eventHandlers:{progress:function(a){if(a.lengthComputable){var b=a.loaded/a.total;c.progress=100*b}}}}).then(function(a){try{localStorage.setItem("parts",JSON.stringify(a.data))}catch(c){}Wyliodrin.schemed.parts=a.data,b.$emit("loaded.wyliodrin.parts")})}function f(a){var b=[];return angular.forEach(a,function(a,c){var d={key:c,title:a.title,type:a.type};"part"===a.type&&(d.id=a.id,d.icon="assets/app/parts/svg/icons/"+a.views.icon),b.push(d),"group"===a.type&&(b=b.concat(f(a.parts)))}),b}function g(a,b){if(a instanceof Array)for(var c=0;c<a.length;c++){var d=g(a[c],b);if(d!==!1)return d}return"group"===a.type?g(a.parts,b):a.id===b?a:!1}function h(a){return g(Wyliodrin.schemed.parts,a)}var i="canvas",j="100%",k="100%",l="grid",m=80,n="none",o="#ddd",p=1,q=d3.behavior.zoom().scaleExtent([.5,4]).on("zoom",a);d3.behavior.drag().origin(function(){return{x:d3.select(this).attr("x"),y:d3.select(this).attr("y")}}).on("dragstart",b).on("drag",c).on("dragend",d);var r=d3.select("#viewport").append("svg:svg").attr("id",i).attr("width",j).attr("height",k).call(q).on("mousedown",function(){r.style("cursor","grabbing")}).on("mouseup",function(){r.style("cursor","grab")}).style("cursor","grab"),s=r.append("defs"),t=s.append("pattern").attr("id","grid-inner").attr("width",8).attr("height",8).attr("patternUnits","userSpaceOnUse");t.append("path").attr("d","M 8 0 L 0 0 0 8").attr("fill",n).attr("stroke","#eee").attr("stroke-width",.5),t=s.append("pattern").attr("id",l).attr("width",m).attr("height",m).attr("patternUnits","userSpaceOnUse"),t.append("rect").attr("fill","url(#grid-inner)").attr("width",m).attr("height",m),t.append("path").attr("d","M "+m+" 0 L 0 0 0 "+m).attr("fill",n).attr("stroke",o).attr("stroke-width",p);var u=r.append("rect").attr("width",j).attr("height",k).attr("fill","url(#"+l+")");u.visible=!0;var v=r.append("g"),w=angular.module("MyApp",["ngMaterial"]);w.config(function(a){a.theme("default").primaryPalette("blue").accentPalette("red")}),w.controller("AppCtrl",function(a,b,c,d){e(a,b,c),c.resetView=function(){q.scale(1),q.translate([0,0]),t.attr("patternTransform",null),v.attr("transform",null)},c.toggleGrid=function(){u.visible=!u.visible;var a=u.visible?"visible":"hidden";u.style("visibility",a)},c.category=null,c.categories=null;var g=d(function(a){b.$on("loaded.wyliodrin.parts",function(){var b=[];angular.forEach(Wyliodrin.schemed.parts,function(a,c){var d={key:c,title:a.title};void 0!==a.icon&&(d.icon="assets/app/parts/icons/"+a.icon),b.push(d)}),c.category=b[2].key,c.categories=b,a()})});c.loadCategories=function(){return c.categories||g},c.parts=null,c.loadCategory=function(){null!==c.category&&(c.parts=f(Wyliodrin.schemed.parts[c.category].parts))},c.$watch("category",c.loadCategory),c.part=null,c.inspect=function(a){var b=h(a);c.part={description:b.description,properties:b.properties,tags:b.tags,title:b.title}},c.deinspect=function(){c.part=null}})}();