"undefined"==typeof window.Wyliodrin&&(window.Wyliodrin={}),function(a){"use strict";a.schemed={parts:[],partsPath:"assets/app/parts/parts.json"}}(Wyliodrin),function(){"use strict";function a(){r.attr("patternTransform","translate("+d3.event.translate+") scale("+d3.event.scale+")"),q.select("path").attr("stroke-width",.5/d3.event.scale),r.select("path").attr("stroke-width",1/d3.event.scale),t.attr("transform","translate("+d3.event.translate+") scale("+d3.event.scale+")")}function b(){d3.event.sourceEvent.stopPropagation(),d3.select(this).classed("dragging",!0)}function c(){d3.select(this).attr("x",d3.event.x).attr("y",d3.event.y)}function d(){d3.select(this).classed("dragging",!1)}function e(a,b,c){var d=localStorage.getItem("parts");return null!==d?(Wyliodrin.schemed.parts=JSON.parse(d),void b.$emit("loaded.wyliodrin.parts")):void a.get(Wyliodrin.schemed.partsPath,{eventHandlers:{progress:function(a){if(a.lengthComputable){var b=a.loaded/a.total;c.progress=100*b}}}}).then(function(a){try{localStorage.setItem("parts",JSON.stringify(a.data))}catch(c){}Wyliodrin.schemed.parts=a.data,b.$emit("loaded.wyliodrin.parts")})}function f(a){var b=[];return angular.forEach(a,function(a,c){var d={key:c,title:a.title,type:a.type};"part"===a.type&&(d.id=a.id,d.icon="assets/app/parts/svg/icons/"+a.views.icon),b.push(d),"group"===a.type&&(b=b.concat(f(a.parts)))}),b}var g="canvas",h="100%",i="100%",j="grid",k=80,l="none",m="#ddd",n=1,o=d3.behavior.zoom().scaleExtent([.5,4]).on("zoom",a);d3.behavior.drag().origin(function(){return{x:d3.select(this).attr("x"),y:d3.select(this).attr("y")}}).on("dragstart",b).on("drag",c).on("dragend",d);var p=d3.select("#viewport").append("svg:svg").attr("id",g).attr("width",h).attr("height",i).call(o).on("mousedown",function(){p.style("cursor","grabbing")}).on("mouseup",function(){p.style("cursor","grab")}).style("cursor","grab"),q=p.append("defs"),r=q.append("pattern").attr("id","grid-inner").attr("width",8).attr("height",8).attr("patternUnits","userSpaceOnUse");r.append("path").attr("d","M 8 0 L 0 0 0 8").attr("fill",l).attr("stroke","#eee").attr("stroke-width",.5),r=q.append("pattern").attr("id",j).attr("width",k).attr("height",k).attr("patternUnits","userSpaceOnUse"),r.append("rect").attr("fill","url(#grid-inner)").attr("width",k).attr("height",k),r.append("path").attr("d","M "+k+" 0 L 0 0 0 "+k).attr("fill",l).attr("stroke",m).attr("stroke-width",n);var s=p.append("rect").attr("width",h).attr("height",i).attr("fill","url(#"+j+")");s.visible=!0;var t=p.append("g"),u=angular.module("MyApp",["ngMaterial"]);u.config(function(a){a.theme("default").primaryPalette("blue").accentPalette("red")}),u.controller("AppCtrl",function(a,b,c,d){e(a,b,c),c.resetView=function(){o.scale(1),o.translate([0,0]),r.attr("patternTransform",null),t.attr("transform",null)},c.toggleGrid=function(){s.visible=!s.visible;var a=s.visible?"visible":"hidden";s.style("visibility",a)},c.category=null,c.categories=null;var g=d(function(a){b.$on("loaded.wyliodrin.parts",function(){var b=[];angular.forEach(Wyliodrin.schemed.parts,function(a,c){var d={key:c,title:a.title};void 0!==a.icon&&(d.icon="assets/app/parts/icons/"+a.icon),b.push(d)}),c.category=b[2].key,c.categories=b,a()})});c.loadCategories=function(){return c.categories||g},c.parts=null,c.loadCategory=function(){null!==c.category&&(c.parts=f(Wyliodrin.schemed.parts[c.category].parts))},c.$watch("category",c.loadCategory)})}();