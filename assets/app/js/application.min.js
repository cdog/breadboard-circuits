"undefined"==typeof window.Wyliodrin&&(window.Wyliodrin={}),function(a){"use strict";a.bc={parts:[],partsPath:"assets/app/parts/parts.json"}}(Wyliodrin),function(){"use strict";function a(){s.attr("patternTransform","translate("+d3.event.translate+") scale("+d3.event.scale+")"),r.select("path").attr("stroke-width",.5/d3.event.scale),s.select("path").attr("stroke-width",1/d3.event.scale),u.attr("transform","translate("+d3.event.translate+") scale("+d3.event.scale+")")}function b(){d3.event.sourceEvent.stopPropagation(),d3.select(this).classed("dragging",!0)}function c(){d3.select(this).attr("x",d3.event.x).attr("y",d3.event.y)}function d(){d3.select(this).classed("dragging",!1)}function e(a,b,c){var d=localStorage.getItem("parts");return null!==d?(Wyliodrin.bc.parts=JSON.parse(d),void b.$emit("bc:library:loaded")):void a.get(Wyliodrin.bc.partsPath,{eventHandlers:{progress:function(a){if(a.lengthComputable){var b=a.loaded/a.total;c.progress=100*b}}}}).then(function(a){try{localStorage.setItem("parts",JSON.stringify(a.data))}catch(c){}Wyliodrin.bc.parts=a.data,b.$emit("bc:library:loaded")})}function f(a,b){if(a instanceof Array)for(var c=0;c<a.length;c++){var d=f(a[c],b);if(d!==!1)return d}return"group"===a.type?f(a.parts,b):a.id===b?a:!1}function g(a){return f(Wyliodrin.bc.parts,a)}var h="canvas",i="100%",j="100%",k="grid",l=80,m="none",n="#ddd",o=1,p=d3.behavior.zoom().scaleExtent([.5,4]).on("zoom",a);d3.behavior.drag().origin(function(){return{x:d3.select(this).attr("x"),y:d3.select(this).attr("y")}}).on("dragstart",b).on("drag",c).on("dragend",d);var q=d3.select("#viewport").append("svg:svg").attr("id",h).attr("width",i).attr("height",j).call(p).on("mousedown",function(){q.style("cursor","grabbing")}).on("mouseup",function(){q.style("cursor","grab")}).style("cursor","grab"),r=q.append("defs"),s=r.append("pattern").attr("id","grid-inner").attr("width",8).attr("height",8).attr("patternUnits","userSpaceOnUse");s.append("path").attr("d","M 8 0 L 0 0 0 8").attr("fill",m).attr("stroke","#eee").attr("stroke-width",.5),s=r.append("pattern").attr("id",k).attr("width",l).attr("height",l).attr("patternUnits","userSpaceOnUse"),s.append("rect").attr("fill","url(#grid-inner)").attr("width",l).attr("height",l),s.append("path").attr("d","M "+l+" 0 L 0 0 0 "+l).attr("fill",m).attr("stroke",n).attr("stroke-width",o);var t=q.append("rect").attr("width",i).attr("height",j).attr("fill","url(#"+k+")");t.visible=!0;var u=q.append("g"),v=angular.module("MyApp",["ngMaterial"]);v.config(function(a){a.theme("default").primaryPalette("blue").accentPalette("red")}),v.controller("AppCtrl",function(a,b,c,d){e(a,b,c),c.resetView=function(){p.scale(1),p.translate([0,0]),s.attr("patternTransform",null),u.attr("transform",null)},c.toggleGrid=function(){t.visible=!t.visible;var a=t.visible?"visible":"hidden";t.style("visibility",a)},c.category=null,c.categories=null;var f=d(function(a){b.$on("bc:library:loaded",function(){var b=[];angular.forEach(Wyliodrin.bc.parts,function(a,c){var d={key:c,title:a.title};void 0!==a.icon&&(d.icon="assets/app/parts/icons/"+a.icon),b.push(d)}),c.category=b[2].key,c.categories=b,a()})});c.loadCategories=function(){return c.categories||f},c.parts=null,c.loadCategory=function(){null!==c.category&&(c.parts=Wyliodrin.bc.parts[c.category].parts)},c.$watch("category",c.loadCategory),c.part=null,c.inspect=function(a){var b=g(a);c.part={description:b.description,properties:b.properties,tags:b.tags,title:b.title}},c.deinspect=function(){c.part=null}})}();