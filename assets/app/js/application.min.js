"undefined"==typeof window.Wyliodrin&&(window.Wyliodrin={}),function(a){"use strict";a.bc={parts:[],partsPath:"assets/app/parts/parts.json"}}(Wyliodrin),function(){"use strict";function a(a,b){return Math.floor(Math.random()*(b-a))+a}function b(){u.attr("patternTransform","translate("+d3.event.translate+") scale("+d3.event.scale+")"),t.select("path").attr("stroke-width",.5/d3.event.scale),u.select("path").attr("stroke-width",1/d3.event.scale),w.attr("transform","translate("+d3.event.translate+") scale("+d3.event.scale+")")}function c(){d3.event.sourceEvent.stopPropagation(),d3.select(this).classed("dragging",!0)}function d(){d3.select(this).attr("x",d3.event.x).attr("y",d3.event.y)}function e(){d3.select(this).classed("dragging",!1)}function f(a,b,c){var d=localStorage.getItem("parts");return null!==d?(Wyliodrin.bc.parts=JSON.parse(d),void b.$emit("bc:library:loaded")):void a.get(Wyliodrin.bc.partsPath,{eventHandlers:{progress:function(a){if(a.lengthComputable){var b=a.loaded/a.total;c.progress=100*b}}}}).then(function(a){try{localStorage.setItem("parts",JSON.stringify(a.data))}catch(c){}Wyliodrin.bc.parts=a.data,b.$emit("bc:library:loaded")})}function g(a,b){if(a instanceof Array)for(var c=0;c<a.length;c++){var d=g(a[c],b);if(d!==!1)return d}return"group"===a.type?g(a.parts,b):a.id===b?a:!1}function h(a){return g(Wyliodrin.bc.parts,a)}var i="canvas",j="100%",k="100%",l="grid",m=80,n="none",o="#ddd",p=1,q=d3.behavior.zoom().scaleExtent([.5,4]).on("zoom",b),r=d3.behavior.drag().origin(function(){return{x:d3.select(this).attr("x"),y:d3.select(this).attr("y")}}).on("dragstart",c).on("drag",d).on("dragend",e),s=d3.select("#viewport").append("svg:svg").attr("id",i).attr("width",j).attr("height",k).call(q).on("mousedown",function(){s.style("cursor","grabbing")}).on("mouseup",function(){s.style("cursor","grab")}).style("cursor","grab"),t=s.append("defs"),u=t.append("pattern").attr("id","grid-inner").attr("width",8).attr("height",8).attr("patternUnits","userSpaceOnUse");u.append("path").attr("d","M 8 0 L 0 0 0 8").attr("fill",n).attr("stroke","#eee").attr("stroke-width",.5),u=t.append("pattern").attr("id",l).attr("width",m).attr("height",m).attr("patternUnits","userSpaceOnUse"),u.append("rect").attr("fill","url(#grid-inner)").attr("width",m).attr("height",m),u.append("path").attr("d","M "+m+" 0 L 0 0 0 "+m).attr("fill",n).attr("stroke",o).attr("stroke-width",p);var v=s.append("rect").attr("width",j).attr("height",k).attr("fill","url(#"+l+")");v.visible=!0;var w=s.append("g"),x=angular.module("MyApp",["ngMaterial"]);x.config(function(a){a.theme("default").primaryPalette("blue").accentPalette("red")}),x.controller("AppCtrl",function(b,c,d,e){f(b,c,d),d.resetView=function(){q.scale(1),q.translate([0,0]),u.attr("patternTransform",null),w.attr("transform",null)},d.toggleGrid=function(){v.visible=!v.visible;var a=v.visible?"visible":"hidden";v.style("visibility",a)},d.category=null,d.categories=null;var g=e(function(a){c.$on("bc:library:loaded",function(){var b=[];angular.forEach(Wyliodrin.bc.parts,function(a,c){var d={key:c,title:a.title};void 0!==a.icon&&(d.icon="assets/app/parts/icons/"+a.icon),b.push(d)}),d.category=b[2].key,d.categories=b,a()})});d.loadCategories=function(){return d.categories||g},d.parts=null,d.loadCategory=function(){if(null!==d.category){var a=Wyliodrin.bc.parts[d.category].parts;"part"===a[0].type&&(a=[{parts:a,type:"group"}]),d.parts=a}},d.$watch("category",d.loadCategory),d.part=null,d.inspect=function(a){var b=h(a);d.part={description:b.description,properties:b.properties,tags:b.tags,title:b.title}},d.deinspect=function(){d.part=null},d.grab=function(b){var c=h(b);d3.xml("assets/app/parts/svg/breadboard/"+c.views.breadboard,"image/svg+xml",function(b){var c=w.node().appendChild(b.documentElement),d=s.node().getBoundingClientRect();d3.select(c).attr("class","component").attr("x",a(0,d.width)).attr("y",a(0,d.height)).call(r)})}})}();